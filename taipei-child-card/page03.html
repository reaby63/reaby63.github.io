<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>33 簽名頁</title>
	<link rel="stylesheet" href="style.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
	<div class="page-else">

		<!-- 置頂標題樣式 -->
		<div class="page-else-title">
			<div class="page-else-title-up">
				<div class="title-1000">
					<div class="else-title-up-in">
						<span class="else-title-left">
							OO家長，您好！
						</span>
						<a class="else-title-right" href="#">
							<img src="img/p2-logout.svg" alt="">
							登出
						</a>
					</div>
				</div>
			</div>
			<div class="page-else-title-down">
				<div class="title-1000">
					<div class="else-title-down-in">
						<!-- 已完成步驟按鈕  -->
						<a href="#" class="else-title-step step-ok">
							<span class="else-title-step-num">
								1
							</span>
							<span class="else-title-step-word">
								確認學生個資
							</span>
							<span class="else-title-step-okmark">
								<img src="img/step-okmark.svg" alt="">
							</span>
						</a>

						<span class="else-title-trangle">
							
							<img src="img/step-trangle.svg" alt="">
						</span>


						<!-- 未完成步驟按鈕  -->
						<a href="#" class="else-title-step step-no">
							<span class="else-title-step-num">
								2
							</span>
							<span class="else-title-step-word">
								申辦親子帳號
							</span>
						</a>
						

						<span class="else-title-trangle">
							
							<img src="img/step-trangle.svg" alt="">
						</span>


						<!-- 未完成步驟按鈕  -->
						<a href="#" class="else-title-step step-no">
							<span class="else-title-step-num">
								3
							</span>
							<span class="else-title-step-word">
								同意簽署回傳
							</span>
						</a>
					</div>
				</div>
			</div>

		</div>



		
		<!-- 第六頁 回傳簽名 待研究-->
		<div class="page-03" >

			<div class="page-03-title">
				親愛的家長，您好。 相關服務申辦情形如下：
			</div>

			<div class="page-06">
				<div class="page-03-info-list">
						<span class="page-03-info-title info-title-big">
							申辦親子帳號服務對象
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							申請人姓名
						</span>
						<span class="page-03-info-words">
							王大明
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							親屬關係
						</span>
						<span class="page-03-info-words">
							父子
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							身分證字號
						</span>
						<span class="page-03-info-words">
							0123456789
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							手機
						</span>
						<span class="page-03-info-words">
							09123456789
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							電子郵件
						</span>
						<span class="page-03-info-words">
							123456@gmail.com
						</span>
					</div>
				</div>

				<div class="page-06">
				<div class="page-03-info-list">
						<span class="page-03-info-title info-title-big">
							申辦親子帳號服務對象
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							申請人姓名
						</span>
						<span class="page-03-info-words">
							周翠翠
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							親屬關係
						</span>
						<span class="page-03-info-words">
							母子
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							身分證字號
						</span>
						<span class="page-03-info-words">
							0123456789
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							手機
						</span>
						<span class="page-03-info-words">
							09123456789
						</span>
					</div>
					<div class="page-03-info-list">
						<span class="page-03-info-title page-04-info">
							電子郵件
						</span>
						<span class="page-03-info-words">
							123456@gmail.com
						</span>
					</div>
				</div>

				<div class="page-03-title page-06-title">
				確認無誤請於下方欄位以手指或滑鼠簽名，並儲存送出，如申辦兩個帳號，則兩位申請人均須簽名。
			</div>

			<div id="bb">

			<div id="canvasDiv" >
				
			</div>

			<br>


			<div class="page-03-btn">
				<button class="btn-check btn-check-ok"  id="btn_submit">
					<img src="img/btn-send.svg" alt="">
					儲存送出
				</button>
				<button class="btn-check btn-check-no" id="btn_clear">
					<img src="img/btn-trash.svg" alt="">
					清空簽名
				</button>
			</div>
			

			<img  id="qmimg"/>
			</div>
			
	
	</div>


	<script language="javascript">


var canvasDiv = document.getElementById('canvasDiv');
var canvas = document.createElement('canvas');
var screenwidth = (window.innerWidth > 0) ? window.innerWidth : screen.width;

var canvasWidth = screenwidth;
var canvasHeight = 320;
document.addEventListener('touchmove', onDocumentTouchMove, false);
var point = {};
point.notFirst = false;
canvas.setAttribute('width', canvasWidth);
canvas.setAttribute('height', canvasHeight);
canvas.setAttribute('id', 'canvas');
canvasDiv.appendChild(canvas);
if (typeof G_vmlCanvasManager != 'undefined') {
    canvas = G_vmlCanvasManager.initElement(canvas);
}
var context = canvas.getContext("2d");
/*var ptrn = context.createPattern(img, 'no-repeat');
context.fillStyle = ptrn;
context.fillRect(0, 0, canvas.width, canvas.height);
*/
var img = new Image();
img.src = "Transparent.png";

img.onload = function() {
    var ptrn = context.createPattern(img, 'repeat');
    context.fillStyle = ptrn;
    context.fillRect(0, 0, canvas.width, canvas.height);
}
canvas.addEventListener("touchstart", function(e) {
	//console.log(e);
    var mouseX = e.touches[0].pageX - this.offsetLeft;
    var mouseY = e.touches[0].pageY - this.offsetTop;
    paint = true;
    addClick(e.touches[0].pageX - this.offsetLeft, e.touches[0].pageY - this.offsetTop);
	//console.log(e.touches[0].pageX - this.offsetLeft, e.touches[0].pageY - this.offsetTop);
    redraw();
});



canvas.addEventListener("touchend", function(e) {
	//console.log("touch end");
    paint = false;
});

canvas.addEventListener("touchmove", function(e) {
    if (paint) {
		//console.log("touchmove");
        addClick(e.touches[0].pageX - this.offsetLeft, e.touches[0].pageY - this.offsetTop, true);
		//console.log(e.touches[0].pageX - this.offsetLeft, e.touches[0].pageY - this.offsetTop);
        redraw();
    }

});

canvas.addEventListener("mousedown", function(e) {
    var mouseX = e.pageX - this.offsetLeft;
    var mouseY = e.pageY - this.offsetTop;
    paint = true;
    addClick(e.pageX - this.offsetLeft, e.pageY - this.offsetTop);
    redraw();
});
canvas.addEventListener("mousemove", function(e) {
    if (paint) {
        addClick(e.pageX - this.offsetLeft, e.pageY - this.offsetTop, true);
        redraw();
    }
});
canvas.addEventListener("mouseup", function(e) {
    paint = false;
});
canvas.addEventListener("mouseleave", function(e) {
    paint = false;
});
document.getElementById("btn_clear").addEventListener("click", function() {
    canvas.width = canvas.width;
});
document.getElementById("btn_submit").addEventListener("click", function() {
    $("#qmimg").attr("src", canvas.toDataURL("image/png"));
});


function onDocumentTouchStart(event) {
    if (event.touches.length == 1) {
        event.preventDefault();
        // Faking double click for touch devices
        var now = new Date().getTime();
        if (now - timeOfLastTouch < 250) {
            reset();
            return;
        }
        timeOfLastTouch = now;
        mouseX = event.touches[0].pageX;
        mouseY = event.touches[0].pageY;
        isMouseDown = true;

    }

}



function onDocumentTouchMove(event) {

    if (event.touches.length == 1) {
        event.preventDefault();
        mouseX = event.touches[0].pageX;
        mouseY = event.touches[0].pageY;
    }
}



function onDocumentTouchEnd(event) {
    if (event.touches.length == 0) {
        event.preventDefault();
        isMouseDown = false;
    }
}


var clickX = new Array();
var clickY = new Array();
var clickDrag = new Array();
var paint;

function addClick(x, y, dragging)
{
    clickX.push(x);
    clickY.push(y);
    clickDrag.push(dragging);
}



function redraw() {

    //canvas.width = canvas.width; // Clears the canvas
    context.strokeStyle = "#df4b26";
    context.lineJoin = "round";
    context.lineWidth = 2;
    while (clickX.length > 0) {
        point.bx = point.x;
        point.by = point.y;
        point.x = clickX.pop();
        point.y = clickY.pop();
        point.drag = clickDrag.pop();
        context.beginPath();
        if (point.drag && point.notFirst) {
            context.moveTo(point.bx, point.by);
        } else {
            point.notFirst = true;
            context.moveTo(point.x - 1, point.y);
        }
        context.lineTo(point.x, point.y);
        context.closePath();
        context.stroke();
    }

    /*

      for(var i=0; i < clickX.length; i++)

      {		

        context.beginPath();

        if(clickDrag[i] && i){

          context.moveTo(clickX[i-1], clickY[i-1]);

         }else{

           context.moveTo(clickX[i]-1, clickY[i]);

         }

         context.lineTo(clickX[i], clickY[i]);

         context.closePath();

         context.stroke();

      }

      */

}
</script>


</body>
</html>